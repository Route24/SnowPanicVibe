# SnowPanic 開発の過去やり取りまとめ

このファイルは、Cursor のチャット履歴が消えてしまった場合に、これまでの開発で決めたこと・実装したことの要点をまとめたものです。

---

## プロジェクト概要

- **ゲーム名**: SnowPanic!CC → **SnowPanicVibe** にリネーム済み
- **コア体験**: 物理演算で屋根の雪を一気に落とす爽快感
- **操作方法**: 地上にいる人が、棒で叩いたり投げたものをロープで引いたりして屋根の雪庇を落とす（屋根の上には乗らない）
- **視点**: 斜め上からの俯瞰視点（屋根上の雪・落ちるところ・落ちた後の屋根を一度に見せる）

---

## ゲームの全体設計（合意済み）

1. **ループ**: 雪を落とす → 落ちた量でおだちん獲得 → 道具を強化 → より広い範囲や大きな家に挑戦
2. **爽快感**: 一定時間内に大量の雪が動くとコンボ発生。連鎖的に崩落する演出
3. **成長要素**: おだちんで雪かきスコップ（範囲拡大）・融雪剤（持続消滅）を購入・強化
4. **ステージ**: 自分の家 → 隣家 → 村全体へ依頼範囲が広がる
5. **優先順位**: コアの物理演算（雪が落ちる気持ちよさ）を先に固める。グラフィック・サウンド・UIは後回し

---

## これまで実装した主な機能

### シーン・見た目
- **三角屋根（A型）の小さな家**、窓がある正面壁
- **屋根の雪**: パーティクルで表現、屋根と同じ面積（1.35×2.02）、屋根が透けない密度（約13000パーティクル）
- **地面の雪**: パーティクル、岩・草を配置して地面と屋根の雪を区別（屋根=白寄り、地面=グレー寄り）
- **降雪パーティクル**: ふわふわ蛇行しながら舞い降りる感じ（初速0.35、重力0.12、ノイズ0.04）
- **カメラ**: 俯瞰視点、家の正面ファサード中央を注視点

### 雪落としの挙動
- **クリックで雪が落ちる**: 屋根の雪をクリックすると雪塊が生成され、**屋根の斜度に沿って滑り落ちる**
- **物理エンジン使用**: Rigidbody、Collider、PhysicsMaterial、AddForce で物理演算
- **雪塊**: 板状（BoxCollider、FreezeRotation）で転がらず滑る。吹き飛ばず滑り落ちる
- **着地後**: 地面に広がって消え、地面の雪として積もる表現

### メニュー・確認手順
- **SnowPanic > Setup Cornice Scene** を実行 → シーン構築
- **SnowPanic > Reset Camera to 俯瞰 View** → 視点リセット
- コード変更後は、必ず Setup Cornice Scene を再実行してから Play で確認

---

## 技術的なポイント（詰めた内容）

| 項目 | 決定内容 |
|------|----------|
| 雪の面積 | 屋根と必ず同じ（親スケールで二重拡大しないよう注意） |
| 雪の見た目 | パーティクルのみ、SnowBase（白い立方体）は削除 |
| 雪塊の挙動 | 初速弱め、linearVelocity で滑る、吹き飛ばさない |
| 屋根形状 | RoofLeft/RoofRight の子として配置、A型屋根に沿う |
| scalingMode | ParticleSystemScalingMode.Hierarchy で屋根サイズに合わせる |

---

## GitHub・その他

- Git の初期設定済み（Kenichi Nishi / route24@mac.com）
- プロジェクト名を SnowPanic!CC → SnowPanicVibe に変更した（`!` のエスケープ問題を避けるため）
- Unity テンプレート: 3D (URP)
- Cursor の Apply: エージェントモードでは直接ファイルを編集するため、Apply ボタンは出ない

---

## 続きからやりたいとき

このファイルを参照するか、「この前の続きで〇〇をやってほしい」と具体的に書けば、この内容を踏まえて作業を進められます。

過去のトランスクリプトは以下に保存されています（Cursor の仕組み上、チャット UI には戻せませんが内容は残っています）:
- SnowPanic-CC: 屋根雪落とし開発のメイン会話
- SnowPanicVibe: 本チャット
